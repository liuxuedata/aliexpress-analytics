version: 2025-01-10
v1:
  codename: atlas
  timeframe: 2025-01-08 ~ 2025-02-15
  focus:
    - 建立统一站点导航与站点配置扩展 Lazada/Shopee
    - 上线运营指标统一模型（site_metrics_daily）与 Temu/TikTok 运营数据接入
    - 启动订单中心 MVP：订单导入、订单列表、状态流转
    - 交付站点左侧模块配置（site_module_configs）与字段覆盖矩阵（platform_metric_profiles）
  deliverables:
    - 更新站点管理页面支持平台筛选与权限开关
    - 发布 admin.html 管理后台（站点配置 + 权限矩阵 + 同步工具）
    - 实现 /api/orders (GET/POST) 与 /api/orders/import dry_run
    - 扩展 /api/ae_upsert 以支持 Lazada/Shopee 字段映射
    - 新增 /api/site-modules (GET/PATCH) 及默认模块模板，附带 availableFields 元数据
    - 加固 Lazada OAuth 回调：以 `/auth/token/create` 生成签名、使用 findKeyDeep 穿透嵌套载荷并持久化 refresh_token，响应附带脱敏调试数据
  metrics:
    - 站点运营数据覆盖率 ≥ 6 个站点
    - 订单导入成功率 ≥ 95%
    - 关键接口平均响应时间 ≤ 2s
  risks:
    - 多平台报表字段差异导致 ingest 映射复杂
    - 站点权限未上线前存在数据泄露风险
    - 左侧导航模块化后权限同步不及时
    mitigations:
      - 在 specs/openapi.yaml 中维护字段映射表
      - 提前实现权限模块的读校验逻辑
      - 引入 site_module_configs.visible_roles 与 metadata.availableFields，前端按权限渲染
      - 为 Lazada 授权回调引入 findKeyDeep/pickDeepValue，确保跳过空值并记录原始载荷，便于排查授权失败

v2:
  codename: orion
  timeframe: 2025-02-16 ~ 2025-03-31
  focus:
    - 上线库存中心（批次、调拨、库存预警）
    - 广告中心（多渠道广告统计 + 配置管理）
    - 权限中心（角色、成员、资源矩阵）
  deliverables:
    - /api/inventory (GET/POST/PATCH) + /api/inventory/import
    - /api/ads/* 家族接口与广告仪表盘页面
    - /api/permissions/roles、/api/permissions/assignments
  metrics:
    - 库存扣减与订单关联准确率 ≥ 98%
    - 广告数据可追溯站点 ≥ 5 个
    - 权限误授权率为 0
  risks:
    - 库存批次与站点仓库映射复杂
    - 广告归因算法存在滞后
    - 模块配置变更影响缓存一致性
  mitigations:
    - 引入 inventory_movements 审计表
    - 设计广告归因延迟处理（lookback window 配置）
    - 为 /api/site-modules 提供 ETag 与缓存失效策略

v3:
  codename: hyperion
  timeframe: 2025-04-01 ~ 2025-05-31
  focus:
    - 深化多渠道数据融合：广告 -> 访客 -> 订单 -> 结算
    - 推出利润分析、采购建议、财务对账
    - 自动化告警与任务编排
  deliverables:
    - 物化视图与指标 API（GMV、毛利、净利、广告 ROI）
    - 财务结算表、采购建议引擎、自动化任务调度脚本
    - 全面接入权限审计与操作日志
  metrics:
    - 利润分析准确率 ≥ 97%
    - 告警响应时间 ≤ 10 分钟
    - 自动化任务成功率 ≥ 98%
  risks:
    - 数据源滞后影响利润准确性
    - 跨团队协作成本高
  mitigations:
    - 引入数据刷新 SLA 与延迟监控
    - 设立跨部门例会与共享文档

debt:
  - 为现有 API 编写自动化测试
  - 引入数据质量监控仪表盘
  - 建立权限模块的 UI 集成测试
  - 编写 site_module_configs / platform_metric_profiles 的迁移脚本与回滚方案
execution_plan:
  atlas:
    sprint_0:
      timeframe: 2025-01-08 ~ 2025-01-14
      goals:
        - 补齐 Temu/TikTok/Lazada/Shopee 站点配置与指标映射
        - 输出 platform_metric_profiles 初版与站点模板
        - 明确角色矩阵并更新 rules.json 权限段落
      owners:
        platform_integration: Platform Integration Squad
        data_engineering: Data Engineering Squad
        access_security: Access & Security Squad
        qa_release: QA & Release Squad
      deliverables:
        - site_configs/site_channel_configs 更新脚本
        - platform_metric_profiles 种子数据
        - 权限策略更新（rules.json）与 QA Checklist 草案
    sprint_1:
      timeframe: 2025-01-15 ~ 2025-01-28
      goals:
        - 实现 /api/site-modules 与站点导航改造
        - 落地订单域核心表结构与导入审计表
        - 交付订单中心 MVP 前端与基础回归脚本
      owners:
        platform_integration: Platform Integration Squad
        frontend_experience: Frontend Experience Squad
        data_engineering: Data Engineering Squad
        access_security: Access & Security Squad
        qa_release: QA & Release Squad
      deliverables:
        - /api/site-modules Serverless 函数与单元测试
        - orders/order_items/customers/inventory/inventory_movements 表及迁移脚本
        - 自运营/全托管/独立站导航改造与订单中心 MVP 页面
        - Ozon 订单中心前端支持商品列置顶、采购件数统计与多列排序，提升履约核对效率
        - site_module_configs 迁移脚本 & QA 回归脚本
    sprint_2:
      timeframe: 2025-01-29 ~ 2025-02-15
      goals:
        - 接入 Lazada/Shopee ingest 与 Temu/TikTok 运营接口
        - 上线 /api/orders (GET/POST/import) 并完成 dry_run 流程
        - Atlas 阶段回归与验收报告
      owners:
        platform_integration: Platform Integration Squad
        data_engineering: Data Engineering Squad
        frontend_experience: Frontend Experience Squad
        qa_release: QA & Release Squad
      deliverables:
        - 扩展后的 ae_upsert/temu/tiktok API 与 OpenAPI 更新
        - 订单导入 API、导入日志与前端上传组件
        - Atlas 验收测试报告与文档同步（README/specs/rules）
  orion:
    preparation:
      timeframe: 2025-02-16 ~ 2025-02-23
      goals:
        - 确认库存中心与广告中心 MVP 范围
        - 完成 /api/inventory 与 /api/ads 详细设计评审
        - 明确权限中心数据流与审计需求
      deliverables:
        - OpenAPI 更新与数据模型补充说明
        - 库存/广告前端线框稿与权限矩阵
    execution:
      timeframe: 2025-02-24 ~ 2025-03-31
      goals:
        - 发布库存中心、广告中心与权限中心
        - 建立 inventory_movements 审计与广告归因延迟策略
      deliverables:
        - /api/inventory/*、/api/ads/*、/api/permissions/* 实现与测试
        - 前端全局设置页面与 Feature Flag 控制
  hyperion:
    planning:
      timeframe: 2025-04-01 ~ 2025-04-14
      goals:
        - 定义利润分析、采购建议、告警编排范围
        - 制定数据刷新 SLA 与告警策略
      deliverables:
        - GMV/毛利 API 设计文档、任务调度蓝图
    execution:
      timeframe: 2025-04-15 ~ 2025-05-31
      goals:
        - 上线利润分析、采购建议、自动化告警
      deliverables:
        - 物化视图、指标 API、调度脚本、审计日志报告
