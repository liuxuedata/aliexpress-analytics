# è·¨å¢ƒç”µå•†æ•°æ®åˆ†æå¹³å°

## é¡¹ç›®æ¦‚è¿°
è·¨å¢ƒç”µå•†æ•°æ®åˆ†æå¹³å°ï¼Œæ”¯æŒå¤šå¹³å°ã€å¤šæ¸ é“çš„å¹¿å‘Šæ•°æ®åˆ†æï¼ŒåŒ…æ‹¬é€Ÿå–é€šã€äºšé©¬é€Šã€TikTok Shopã€Temuã€Ozonç­‰å¹³å°çš„æ•°æ®æ•´åˆä¸åˆ†æã€‚

## å…¨å±€æ¶æ„è§„åˆ’ï¼ˆ2025-01-07 æ›´æ–°ï¼‰
- ğŸ‘‰ è¯¦è§ã€Š[è·¨å¢ƒç”µå•†ç®¡ç†å¹³å°æ¶æ„è“å›¾](docs/platform-architecture.md)ã€‹ï¼Œè¦†ç›–ç«™ç‚¹çŸ©é˜µã€æ¨¡å—èŒè´£ã€æ•°æ®æµåŠæ‰©å±•è®¡åˆ’ã€‚ã€F:docs/platform-architecture.mdâ€ L1-L118ã€‘
- **ç«™ç‚¹çŸ©é˜µ**ï¼šä¿ç•™é€Ÿå–é€šè‡ªè¿è¥ï¼ˆRobot/Poolslabï¼‰ã€å…¨æ‰˜ç®¡ã€ç‹¬ç«‹ç«™ã€äºšé©¬é€Šã€Ozon ç­‰æ—¢æœ‰é¡µé¢ï¼Œå¹¶ä¸º Temuã€TikTokã€Lazadaã€Shopee é¢„ç•™å¯¼èˆªä¸æ•°æ®æ¥å…¥è·¯å¾„ï¼Œå½¢æˆç»Ÿä¸€å…¥å£ã€‚ã€F:docs/platform-architecture.mdâ€ L12-L52ã€‘
- **æ¨¡å—è“å›¾**ï¼šé™¤è¿è¥åˆ†æå¤–ï¼Œæ–°å¢è®¢å•ç®¡ç†ã€åº“å­˜ç®¡ç†ã€å¹¿å‘Šä¸­å¿ƒä¸æƒé™ä¸­å¿ƒå››å¤§ä¸šåŠ¡åŸŸï¼Œåˆ†åˆ«è´Ÿè´£è®¢å•é—­ç¯ã€åº“å­˜æ‰¹æ¬¡ä¸è°ƒæ‹¨ã€å¹¿å‘Šå½’å› ä»¥åŠè·¨å›¢é˜Ÿè®¿é—®æ§åˆ¶ã€‚ã€F:docs/platform-architecture.mdâ€ L54-L119ã€‘
- **æ•°æ®æµä¸æŒ‡æ ‡**ï¼šç»Ÿä¸€ä½¿ç”¨â€œæ›å…‰ â†’ è®¿å®¢ â†’ åŠ è´­ â†’ ä¸‹å• â†’ æ”¯ä»˜ â†’ æ”¯ä»˜é‡‘é¢â€é“¾è·¯ï¼Œå¹¶å°†æŒ‡æ ‡å®šä¹‰ã€OpenAPI è§„èŒƒä¸ SQL æ•°æ®æ¨¡å‹åˆ†åˆ«æ²‰æ·€åœ¨ `specs/metrics_dictionary.md`ã€`specs/openapi.yaml`ã€`specs/data-model.sql` ä¸­ï¼Œç¡®ä¿è·¨å¹³å°ä¸€è‡´æ€§ã€‚ã€F:docs/platform-architecture.mdâ€ L73-L118ã€‘ã€F:specs/metrics_dictionary.mdâ€ L1-L20ã€‘ã€F:specs/openapi.yamlâ€ L1-L369ã€‘ã€F:specs/data-model.sqlâ€ L1-L209ã€‘
- **å¤šå¹³å°æ‰©å±•**ï¼šé€šè¿‡ `site-configs` æ³¨å†Œæ–°ç«™ç‚¹ï¼ˆå¦‚ Lazada/Shopeeï¼‰ï¼Œå¹¶æ‰©å±• ingest/API å³å¯å¿«é€Ÿä¸Šçº¿ï¼Œç›¸å…³æ­¥éª¤åœ¨è“å›¾åŠè·¯çº¿å›¾ä¸­ç»™å‡ºã€‚ã€F:docs/platform-architecture.mdâ€ L31-L116ã€‘ã€F:roadmap.yamlâ€ L1-L49ã€‘
- **æ‰§è¡ŒæŒ‡å¼•**ï¼šä¼˜å…ˆå»ºè®¾æƒé™æ ¡éªŒã€å†å¹¶è¡Œæ¨è¿›è®¢å•ä¸åº“å­˜ç­‰æ¨¡å—ï¼Œå¹¶åœ¨ CI ä¸­å¼ºåˆ¶æ ¡éªŒè§„åˆ™ä¸è§„æ ¼åŒæ­¥ï¼Œé™ä½å¤šäººåä½œé£é™©ã€‚ã€F:docs/platform-architecture.mdâ€ L120-L162ã€‘ã€F:rules.jsonâ€ L1-L54ã€‘

## æ ¸å¿ƒåŠŸèƒ½

### ğŸ¯ å¤šæ¸ é“æ¶æ„ (2025-01-06 æ›´æ–°)
- **æ”¯æŒå¹³å°**ï¼šGoogle Adsã€Facebook Adsã€TikTok Ads
- **ç»Ÿä¸€æ•°æ®è¡¨**ï¼š
  - `independent_facebook_ads_daily` - Facebook Adsç»Ÿä¸€è¡¨
  - `independent_tiktok_ads_daily` - TikTok Adsç»Ÿä¸€è¡¨  
  - `independent_landing_metrics` - Google Adsç»Ÿä¸€è¡¨
- **ç«™ç‚¹æ¸ é“é…ç½®**ï¼šé€šè¿‡ `site_channel_configs` è¡¨ç®¡ç†å„ç«™ç‚¹çš„æ¸ é“å¯ç”¨çŠ¶æ€
- **APIç«¯ç‚¹**ï¼š
  - `/api/independent/facebook-ingest` - Facebook Adsæ•°æ®ä¸Šä¼ 
  - `/api/independent/tiktok-ingest` - TikTok Adsæ•°æ®ä¸Šä¼ 
  - `/api/independent/ingest` - Google Adsæ•°æ®ä¸Šä¼ 
  - `/api/independent/stats?channel=<channel>` - å¤šæ¸ é“æ•°æ®æŸ¥è¯¢
  - `/api/ae_query` - é€Ÿå–é€šè‡ªè¿è¥æ•°æ®æŸ¥è¯¢ï¼ˆ`visitor_ratio`ã€`add_to_cart_ratio`ã€`payment_ratio` ç­‰æ¯”ç‡å­—æ®µä»¥0-1çš„å°æ•°è¿”å›ï¼‰

### ğŸ“Š æ•°æ®åˆ†æåŠŸèƒ½
- **è¿è¥åˆ†æ**ï¼šKPIå¯¹æ¯”ã€è¶‹åŠ¿åˆ†æã€å‘¨æœŸå¯¹æ¯”
- **äº§å“åˆ†æ**ï¼šäº§å“è¡¨ç°ã€è½¬åŒ–æ¼æ–—ã€ROIåˆ†æ
- **æ•°æ®æ˜ç»†**ï¼šæ”¯æŒå¤šç»´åº¦ç­›é€‰å’Œå¯¼å‡º

### ğŸª å¹³å°æ”¯æŒ
- **é€Ÿå–é€š**ï¼šå…¨æ‰˜ç®¡ã€è‡ªè¿è¥
- **äºšé©¬é€Š**ï¼šæ•°æ®å¯¼å…¥ä¸åˆ†æ
- **TikTok Shop**ï¼šå¹¿å‘Šæ•°æ®åˆ†æ
- **Temu**ï¼šå¹³å°æ•°æ®æ•´åˆ
- **Ozon**ï¼šä¿„ç½—æ–¯å¸‚åœºåˆ†æ
- **ç‹¬ç«‹ç«™**ï¼šå¤šæ¸ é“å¹¿å‘Šæ•°æ®ç»Ÿä¸€ç®¡ç†

## ç«™ç‚¹æ¡†æ¶ä¸é¡µé¢èŒè´£
- **å…¥å£é¡µ `public/index.html`**ï¼šä½œä¸ºå¹³å°é—¨æˆ·ï¼Œå†…ç½®æ¸å˜è¿‡æ¸¡å’ŒåŠ è½½åŠ¨ç”»ï¼Œå¹¶åœ¨ 1 ç§’å†…è‡ªåŠ¨é‡å®šå‘åˆ°è‡ªè¿è¥ Robot ç«™ï¼Œç¡®ä¿é»˜è®¤è½åœ°é¡µä¸€è‡´ã€‚ã€F:public/index.htmlâ€ L1-L58ã€‘
- **è‡ªè¿è¥é¡µ `public/self-operated.html`**ï¼šèšåˆ DataTablesã€EChartsã€Flatpickr ç­‰åº“ï¼Œæä¾›ç«™ç‚¹é€‰æ‹©ã€è¿è¥åˆ†æã€äº§å“åˆ†æä¸æ•°æ®æ˜ç»†ä¸‰å¤§æ¨¡å—ï¼Œæ”¯æŒ KPI å¡ç‰‡ã€æ¼æ–—å›¾å’Œæ—¶é—´åºåˆ—è¶‹åŠ¿ï¼›é»˜è®¤ç«™ç‚¹åŒ…å« Robot ä¸ Poolslabï¼Œä¸¤è€…åœ¨å¯¼èˆªä¸­å¯å¿«é€Ÿåˆ‡æ¢ã€‚ã€F:public/self-operated.htmlâ€ L1-L132ã€‘ã€F:public/assets/site-nav.jsâ€ L1-L82ã€‘
- **å…¨æ‰˜ç®¡é¡µ `public/managed.html`**ï¼šå¸¦ç™»å½•è¦†ç›–å±‚ä¸ç»Ÿä¸€ä¾§è¾¹æ ï¼Œé¡¶éƒ¨å¯¼èˆªæ¶µç›–é€Ÿå–é€šã€äºšé©¬é€Šã€TikTokâ€¯Shopã€Temuã€Ozonã€ç‹¬ç«‹ç«™ç­‰å¹³å°ï¼›é¡µé¢å†…æŒ‰ Hash åˆ‡åˆ†è¯¦ç»†æ•°æ®ã€è¿è¥åˆ†æä¸äº§å“åˆ†æï¼Œå¹¶æ”¯æŒä¸Šä¼ å…¨æ‰˜ç®¡å‘¨/æœˆæŠ¥è¡¨ã€‚ã€F:public/managed.htmlâ€ L1-L134ã€‘
- **ç«™ç‚¹ç®¡ç†é¡µ `public/site-management.html`**ï¼šæä¾›æ·±è‰²é¡¶æ  + å¡ç‰‡å¼ç½‘æ ¼å¸ƒå±€ï¼Œå†…ç½®ç«™ç‚¹åˆ—è¡¨ä¸æ–°å¢è¡¨å•ï¼Œå¯ç®¡ç† `site_configs` çš„åç§°ã€å¹³å°ã€æ•°æ®æºã€æ¨¡æ¿ç­‰å­—æ®µï¼Œæ”¯æ’‘å¤šå¹³å°æ‰©å±•ã€‚ã€F:public/site-management.htmlâ€ L1-L120ã€‘
- **ç‹¬ç«‹ç«™é¡µ `public/independent-site.html`**ï¼šé¢å‘ Landing Page è¿è¥åˆ†æï¼ŒåŒ…å«æ¸ é“é€‰æ‹©ã€æ—¶é—´æ§ä»¶ã€KPI å¡ç‰‡ä¸æ•°æ®æ˜ç»†ï¼Œå¹¶ä¿ç•™åˆ—æ˜¾éšã€äº§å“åŒå‡»è·³è½¬ç­‰å¢å¼ºäº¤äº’ã€‚ã€F:public/independent-site.htmlâ€ L1-L120ã€‘
- **äºšé©¬é€Šæ€»è§ˆ `public/amazon-overview.html`**ï¼šæŒ‰ Amazon æŒ‡æ ‡æ„å»º KPIã€è¶‹åŠ¿å›¾å’Œæ˜ç»†è¡¨çš„æ€»è§ˆé¡µï¼Œä¾§è¾¹æ è”åŠ¨ `amazon-ads.html` çš„å¹¿å‘Šè§†å›¾ã€‚ã€F:public/amazon-overview.htmlâ€ L1-L120ã€‘
- **Ozon é¡µé¢é›†**ï¼š`public/ozon-detail.html` ç­‰é¡µé¢æä¾›ä¸Šä¼ å…¥å£ã€æ—¥æœŸç­›é€‰åŠå¤šå›¾è¡¨åˆ†æ ï¼Œæ¶µç›–æ˜ç»†ã€è¿è¥åˆ†æå’Œäº§å“æ´å¯Ÿä¸‰ç§è§†å›¾ã€‚ã€F:public/ozon-detail.htmlâ€ L1-L120ã€‘
- **Temu/TikTok å ä½é¡µ**ï¼š`public/temu.html` ä¸ `public/tiktok.html` å·²æ¥å…¥ç»Ÿä¸€å¯¼èˆªä¸å¸ƒå±€ï¼Œç›®å‰æ ‡è®°ä¸ºâ€œå»ºè®¾ä¸­â€ï¼Œç­‰å¾…åç«¯æ¥å£è¡¥é½ã€‚ã€F:public/temu.htmlâ€ L1-L38ã€‘ã€F:public/tiktok.htmlâ€ L1-L36ã€‘

### å·¦ä¾§å¯¼èˆªä¸å­æ¨¡å—
- **å››è±¡é™å¯¼èˆª**ï¼šæ‰€æœ‰ç«™ç‚¹é¡µé¢å·¦ä¾§å›ºå®šå±•ç¤ºâ€œè¿è¥åˆ†æâ€â€œäº§å“åˆ†æâ€â€œè®¢å•ä¸­å¿ƒâ€â€œå¹¿å‘Šä¸­å¿ƒâ€å››ä¸ªå¯¼èˆªé¡¹ï¼Œåˆ†åˆ«åŠ è½½ç‹¬ç«‹çš„ç»„ä»¶ä¸çŠ¶æ€å®¹å™¨ï¼Œé¿å…æ¨¡å—ä¹‹é—´äº§ç”Ÿéšè—è€¦åˆã€‚
- **ç©ºçŠ¶æ€å ä½**ï¼šå½“æŸæ¨¡å—å°šæœªå°±ç»ªï¼ˆå¦‚ Temu å¹¿å‘Šä¸­å¿ƒï¼‰æ—¶ä»ä¿ç•™å¯¼èˆªé¡¹ï¼Œå†…å®¹åŒºæ˜¾ç¤ºå»ºè®¾ä¸­è¯´æ˜ï¼Œå¹¶æŒ‡å‘ `roadmap.yaml` å¯¹åº”é‡Œç¨‹ç¢‘ï¼Œç¡®ä¿ä¿¡æ¯é€æ˜ã€‚
- **å…¨å±€è®¾ç½®å…¥å£**ï¼šåº“å­˜ç®¡ç†ä¸æƒé™ç®¡ç†ä½œä¸ºå…¨ç«™è®¾ç½®ï¼Œä»é¡¶æ æˆ–ç”¨æˆ·èœå•è¿›å…¥ï¼Œä»…å¯¹ `super_admin`ã€`inventory_manager`ã€`permissions_admin` ç­‰è§’è‰²æ¸²æŸ“ï¼›å‰ç«¯åœ¨æƒé™ä¸è¶³æ—¶ä¸ç”Ÿæˆå¯¹åº” DOM å…ƒç´ ï¼Œé¿å…è¯¯è§¦å‘ã€‚
- **ç«™ç‚¹å·®å¼‚åŒ–**ï¼šå„ç«™ç‚¹å¯åœ¨å››ä¸ªå¯¼èˆªé¡¹ä¸­æ¥å…¥è‡ªå®šä¹‰è§†å›¾ï¼Œå¦‚äºšé©¬é€Šè®¢å•ä¸­å¿ƒå¼ºè°ƒ ASIN ç»´åº¦ï¼Œè‡ªè¿è¥ç«™ç‚¹å¹¿å‘Šä¸­å¿ƒèšç„¦ç«™å†…æŠ•æ”¾ï¼›å·®å¼‚å­—æ®µéœ€åœ¨æœ¬æ–‡æ¡£åŠ `docs/platform-architecture.md` ä¸­å•ç‹¬æ ‡æ³¨ã€‚

### ç«™ç‚¹ä¸æ¸ é“åˆ†ç±»
- **é€Ÿå–é€šè‡ªè¿è¥**ï¼šé»˜è®¤æä¾› Robot ç«™ï¼ˆ`ae_self_operated_a`ï¼‰ä¸ Poolslab ç«™ï¼ˆ`ae_self_operated_poolslab_store`ï¼‰ï¼Œå¯é€šè¿‡ç«™ç‚¹é€‰æ‹©å™¨å’Œ `localStorage` è®°å¿†åˆ‡æ¢ã€‚ã€F:public/assets/site-nav.jsâ€ L15-L82ã€‘
- **é€Ÿå–é€šå…¨æ‰˜ç®¡**ï¼šé€šè¿‡é¡¶éƒ¨â€œé€Ÿå–é€š â†’ å…¨æ‰˜ç®¡â€ä¸‹æ‹‰èœå•åŠ è½½ç«™ç‚¹åˆ—è¡¨ï¼Œé…åˆä¸Šä¼ æ§ä»¶ä¸å¤šå›¾è¡¨åˆ†æã€‚ã€F:public/managed.htmlâ€ L9-L122ã€‘
- **ç‹¬ç«‹ç«™**ï¼šæ”¯æŒ Facebookã€Googleã€TikTok æ¸ é“ï¼Œç«™ç‚¹é»˜è®¤åŒ…å« `poolsvacuum.com` ä¸ `icyberite.com`ï¼Œå¹¶åœ¨å¯¼èˆªä¸‹æ‹‰ä¸é¡µé¢å†…åŒæ­¥æ˜¾ç¤ºã€‚ã€F:public/assets/site-nav.jsâ€ L19-L123ã€‘
- **å¤šå¹³å°æ‰©å±•**ï¼šå¯¼èˆªæ¡ä¿ç•™ Amazonã€Ozonã€TikTokâ€¯Shopã€Temuã€ç‹¬ç«‹ç«™å…¥å£ï¼Œä¸ºæœªæ¥æ–°å¢ Lazadaã€Shopee ç­‰ç«™ç‚¹æä¾›ç»Ÿä¸€å£³å±‚ä¸å¯¼èˆªä½ç½®ã€‚ã€F:public/managed.htmlâ€ L25-L54ã€‘

### ä¸šåŠ¡æ¨¡å—è§„åˆ’ï¼ˆæ–°å¢ï¼‰
- **è®¢å•ä¸­å¿ƒ**ï¼šä»¥ `orders`ã€`order_items`ã€`fulfillments`ã€`payments` ç­‰è¡¨æ”¯æ’‘è®¢å•å…¨é“¾è·¯ï¼Œè¦†ç›–è®¢å•å¯¼å…¥ã€çŠ¶æ€æµè½¬ã€åˆ©æ¶¦åˆ†æï¼Œå¹¶è§„åˆ’â€œè®¢å•ä¸­å¿ƒâ€å‰ç«¯é¡µé¢ã€‚ã€F:docs/platform-architecture.mdâ€ L83-L106ã€‘ã€F:specs/data-model.sqlâ€ L16-L94ã€‘
- **åº“å­˜ä¸­å¿ƒ**ï¼šé€šè¿‡ `inventory_batches`ã€`inventory_movements`ã€`inventory_snapshots` å»ºç«‹æ‰¹æ¬¡ã€è°ƒæ‹¨ä¸é¢„è­¦èƒ½åŠ›ï¼Œè®¢å•å‡ºåº“ä¸é‡‡è´­å…¥åº“å‡éœ€äº§ç”Ÿæ—¥å¿—ã€‚ã€F:docs/platform-architecture.mdâ€ L107-L123ã€‘ã€F:specs/data-model.sqlâ€ L96-L138ã€‘
- **å¹¿å‘Šä¸­å¿ƒ**ï¼šé›†ä¸­ç®¡ç†å¹¿å‘Šè´¦æˆ·ã€ç³»åˆ—ã€ç´ æä¸æ—¥æŒ‡æ ‡ï¼Œæ”¯æ’‘é¢„ç®—ã€æŠ•æ”¾é…ç½®ä¸å½’å› åˆ†æï¼Œå¯¹åº” API è§ `specs/openapi.yaml` çš„ `/api/ads/*` å®šä¹‰ã€‚ã€F:docs/platform-architecture.mdâ€ L124-L133ã€‘ã€F:specs/openapi.yamlâ€ L520-L612ã€‘ã€F:specs/data-model.sqlâ€ L140-L186ã€‘
- **æƒé™ä¸­å¿ƒ**ï¼šé‡‡ç”¨ RBAC + èµ„æºèŒƒå›´æ¨¡å‹ï¼Œè®°å½•è§’è‰²ã€æƒé™ã€æˆå‘˜ä¸å®¡è®¡æ—¥å¿—ï¼Œä¿éšœä¸åŒå›¢é˜Ÿçš„æ¨¡å—è®¿é—®éš”ç¦»ã€‚ã€F:docs/platform-architecture.mdâ€ L134-L148ã€‘ã€F:specs/data-model.sqlâ€ L188-L230ã€‘ã€F:rules.jsonâ€ L39-L54ã€‘
- **æ¨¡å—éš”ç¦»åŸåˆ™**ï¼šå„ç«™ç‚¹å†…çš„è¿è¥åˆ†æã€äº§å“åˆ†æã€è®¢å•ç®¡ç†ã€å¹¿å‘Šç®¡ç†è§†å›¾åœ¨å‰ç«¯/åç«¯å‡ä¿æŒç‹¬ç«‹æ¥å£ä¸çŠ¶æ€ï¼Œç¦æ­¢åœ¨ä¸ç»æ–‡æ¡£ç™»è®°çš„æƒ…å†µä¸‹å¤ç”¨åŒä¸€ API å“åº”æˆ–å…±äº«ç¼“å­˜ï¼Œä»¥ä¾¿é’ˆå¯¹ä¸åŒå¹³å°å·®å¼‚åŒ–æ‰©å±•ã€‚

## API æ¥å£ä¸å‚æ•°è¯´æ˜

### é€šç”¨ä¸ç«™ç‚¹ç®¡ç†
- `GET /api/health`ï¼šè¿”å›å½“å‰è¯·æ±‚æ–¹æ³•ã€URLã€æ—¶é—´æˆ³ä¸è¿è¡Œç¯å¢ƒçš„å¥åº·çŠ¶æ€å“åº”ã€‚ã€F:api/health.jsâ€ L1-L19ã€‘
- `GET /api/sites`ï¼šæ‹‰å– `sites` è¡¨å†…å¯ç”¨ç«™ç‚¹åˆ—è¡¨ï¼Œä¾›å‰ç«¯å¯¼èˆªå’Œä¸‹æ‹‰é€‰æ‹©ä½¿ç”¨ã€‚ã€F:api/sites/index.jsâ€ L1-L44ã€‘
- `GET /api/site-configs`ï¼šæšä¸¾ `site_configs` å…¨é‡é…ç½®ï¼Œç”¨äºç«™ç‚¹ç®¡ç†é¡µé¢æ¸²æŸ“ï¼›`POST` è¯·æ±‚å¯åˆ›å»ºæ–°ç«™ç‚¹ï¼Œéœ€è¦æä¾› `name`ã€`platform`ã€`display_name`ã€`data_source` ç­‰å­—æ®µï¼Œç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆ `platform_name` ç»„åˆçš„ç«™ç‚¹ IDã€‚ã€F:api/site-configs/index.jsâ€ L1-L87ã€‘
- `PUT /api/site-configs/[id]`ï¼šæŒ‰ ID æ›´æ–°ç«™ç‚¹é…ç½®å­—æ®µï¼Œæ”¯æŒåŒæ­¥ä¿®æ”¹ `name`ã€`platform`ã€`data_source`ã€`config_json` ç­‰ä¿¡æ¯ï¼›`DELETE` å¯ç§»é™¤ç«™ç‚¹è®°å½•ã€‚ã€F:api/site-configs/[id].jsâ€ L1-L88ã€‘
- `POST /api/site-configs/update`ï¼šæä¾›ä¸ `PUT` ç­‰ä»·çš„æ›´æ–°å…¥å£ï¼Œä¾¿äºå‰ç«¯é€šè¿‡ç»Ÿä¸€ POST è¡¨å•æäº¤ã€‚ã€F:api/site-configs/update.jsâ€ L1-L74ã€‘
- `POST /api/site-sync`ï¼šåœ¨ç«™ç‚¹åˆ›å»ºæˆ–é‡å‘½åæ—¶åŒæ­¥ `ae_self_operated_daily` ç­‰æ•°æ®è¡¨çš„ `site` å­—æ®µï¼Œå¯åœ¨è¯·æ±‚ä½“ä¸­ä¼ å…¥ `siteId`ã€`oldSiteId`ã€`action`ï¼ˆ`create`/`update`ï¼‰ã€‚ã€F:api/site-sync/index.jsâ€ L1-L111ã€‘
- **å¹³å°æ‰©å±•æŒ‡å¼•**ï¼š`site_configs` çš„ `platform` å­—æ®µä¸ºè‡ªç”±æ–‡æœ¬ï¼Œå¯ç›´æ¥ä»¥ `lazada`ã€`shopee` ç­‰å¹³å°ååˆ›å»ºæ–°é…ç½®ï¼›`data_source`/`template_id` å¯å¼•ç”¨ `data_source_templates` ä¸­çš„é¢„è®¾æ˜ å°„ï¼Œå¿…è¦æ—¶é€šè¿‡ `generate_dynamic_table` åˆ›å»ºå¯¹åº”æ—¥è¡¨ç»“æ„ã€‚ã€F:site_configuration_framework.sqlâ€ L1-L118ã€‘

### é€Ÿå–é€š Â· è‡ªè¿è¥ï¼ˆRobot / Poolslabï¼‰
- `GET /api/ae_query`ï¼šæŒ‰ `start`ã€`end`ã€`site`ï¼ˆå¦‚ `ae_self_operated_a`ï¼‰ã€`granularity`ï¼ˆ`day`/`week`/`month`ï¼‰å’Œ `aggregate`ï¼ˆ`time`/`product`ï¼‰èšåˆè‡ªè¿è¥æ˜ç»†ï¼Œè¿”å›æ›å…‰ã€è®¿å®¢ã€åŠ è´­ã€æ”¯ä»˜åŠæ´¾ç”Ÿæ¯”ç‡ã€‚ã€F:api/ae_query/index.jsâ€ L1-L150ã€‘
- `GET /api/ae_self_operated/stats`ï¼šé¢å‘è¿è¥åˆ†æé¡µé¢ï¼Œæ”¯æŒ `site`ã€`from`ã€`to`ã€`limit` å‚æ•°ï¼Œè¿”å›æ—¶é—´åºåˆ—ã€KPI æ±‡æ€»å’Œçƒ­é—¨å•†å“åˆ—è¡¨ã€‚ã€F:api/ae_self_operated/stats/index.jsâ€ L1-L118ã€‘
- `POST /api/ae_upsert[?dry_run=1]`ï¼šæ¥æ”¶ JSON æ•°ç»„æˆ– `{rows:[]}` ç»“æ„ï¼Œä¾æ®å­—æ®µåŒä¹‰è¯æ˜ å°„å…¥åº“ï¼›`dry_run=1` æ—¶ä»…è§£æå¹¶è¿”å›æ ·ä¾‹ï¼Œä¸å†™åº“ã€‚ã€F:api/ae_upsert/index.jsâ€ L1-L120ã€‘

### é€Ÿå–é€š Â· å…¨æ‰˜ç®¡
- `GET /api/stats`ï¼šæŒ‰ `granularity`ï¼ˆ`week`/`month`ï¼‰ä¸å¯é€‰ `product_id`ã€`from`ã€`to`ã€`period_end`ã€`limit`ã€`offset` æŸ¥è¯¢ `managed_stats`ï¼Œè¿”å› KPI æ¦‚è§ˆåŠåˆ†é¡µæ˜ç»†ã€‚ã€F:api/stats/index.jsâ€ L1-L118ã€‘
- `GET /api/managed/daily-totals`ï¼šåŸºäº `from`ã€`to` è®¡ç®—æ¯æ—¥/æ¯å‘¨è®¿å®¢ã€åŠ è´­ã€æ”¯ä»˜æ€»é‡ï¼Œä¼˜å…ˆæ—¥ç²’åº¦ï¼Œè‹¥ç¼ºå¤±è‡ªåŠ¨å›é€€å‘¨ç²’åº¦ã€‚ã€F:api/managed/daily-totals/index.jsâ€ L1-L46ã€‘
- `POST /api/ingest[?dry_run=1]`ï¼šä¸Šä¼ é€Ÿå–é€šå…¨æ‰˜ç®¡ Excelï¼ˆ`file` å­—æ®µï¼‰ï¼Œè‡ªåŠ¨è¯†åˆ«ç»Ÿè®¡å‘¨æœŸï¼ˆå‘¨æ—¥æˆ–æœˆæœ«ï¼‰ï¼Œæ™ºèƒ½åŒ¹é…è¡¨å­—æ®µå¹¶å†™å…¥ `managed_stats`ï¼›`dry_run` æ¨¡å¼ä»…è¿”å›è§£æç»“æœã€‚ã€F:api/ingest/index.jsâ€ L1-L140ã€‘

### ç‹¬ç«‹ç«™ Â· Facebook / Google / TikTok
- `GET /api/independent/stats`ï¼šæ¥å— `site`ã€`channel`ã€`from`ã€`to`ã€`limit` åŠå¯é€‰ `campaign`ã€`network`ã€`device` ç­‰è¿‡æ»¤æ¡ä»¶ï¼Œæ ¹æ®æ¸ é“è‡ªåŠ¨æ˜ å°„æ•°æ®è¡¨å¹¶è¿”å› KPIã€æ—¶é—´åºåˆ—å’Œæ˜ç»†ã€‚ã€F:api/independent/stats/index.jsâ€ L1-L176ã€‘
- `GET /api/independent/sites`ï¼šä»ç»Ÿä¸€çš„ `independent_landing_metrics` è¡¨æå–å·²å­˜åœ¨çš„ç«™ç‚¹åˆ—è¡¨ç”¨äºä¸‹æ‹‰é€‰æ‹©ã€‚ã€F:api/independent/sites/index.jsâ€ L1-L20ã€‘
- `POST /api/independent/ingest`ï¼šç”¨äº Google Ads Landing Pages æŠ¥è¡¨ä¸Šä¼ ï¼Œæ¥æ”¶ `file` å­—æ®µçš„ CSV/XLSXï¼Œè§£æ URLã€æ¸ é“ã€è´¹ç”¨ç­‰å­—æ®µå¹¶å†™å…¥ç»Ÿä¸€è¡¨ï¼Œè‡ªåŠ¨å»é‡ä¸»é”®å†²çªã€‚ã€F:api/independent/ingest/index.jsâ€ L1-L160ã€‘
- `POST /api/independent/facebook-ingest`ï¼šè§£æ Facebook Ads å¯¼å‡ºï¼Œæ‹†åˆ†å•†å“ ID/åç§°å¹¶ç»´æŠ¤ `independent_first_seen` çš„é¦–è´­æ—¶é—´ï¼›åŒæ ·æ”¯æŒè¡¨å­—æ®µæ˜ å°„ä¸æ‰¹é‡ upsertã€‚ã€F:api/independent/facebook-ingest/index.jsâ€ L1-L160ã€‘
- `POST /api/independent/tiktok-ingest`ï¼šå¤„ç† TikTok Ads æŠ¥è¡¨æ–‡ä»¶ï¼Œå…¼å®¹å¤šç§æ—¥æœŸæ ¼å¼å¹¶åŒæ­¥æ›´æ–° `independent_first_seen`ï¼Œä¿æŒå•†å“é¦–è§æ—¶é—´ä¸€è‡´ã€‚ã€F:api/independent/tiktok-ingest/index.jsâ€ L1-L160ã€‘

### äºšé©¬é€Š
- `GET /api/amazon/query`ï¼šåŸºäº `start`ã€`end`ã€`granularity` èšåˆ `amazon_daily_by_asin`ï¼Œè¿”å›ä¼šè¯ã€æµè§ˆã€é”€é‡ã€GMVã€Buy Box å æ¯”ç­‰æŒ‡æ ‡ï¼Œæ”¯æŒæŒ‰ ASIN ä¸æ—¶é—´æ¡¶åˆå¹¶ã€‚ã€F:api/amazon/query/index.jsâ€ L1-L86ã€‘
- `POST /api/amazon/upsert`ï¼šæ¥å— JSON æ•°ç»„æˆ– `{rows:[]}`ï¼ŒæŒ‰ `marketplace_id + asin + stat_date` å»é‡å†™å…¥ï¼Œæ”¯æŒæ‰¹é‡åˆ†å—ä¸Šä¼ ã€‚ã€F:api/amazon/upsert/index.jsâ€ L1-L59ã€‘
- `POST /api/amazon/report-create`ï¼šä»£ç† Amazon SP-API åˆ›å»º `GET_SALES_AND_TRAFFIC_REPORT` æŠ¥è¡¨ï¼Œéœ€ä¼  `dataStartTime`ã€`dataEndTime` å¹¶æ ¡éªŒç›¸å…³ç¯å¢ƒå˜é‡ã€‚ã€F:api/amazon/report-create/index.jsâ€ L1-L97ã€‘
- `GET /api/amazon/report-poll`ï¼šæŸ¥è¯¢æŠ¥è¡¨å¤„ç†çŠ¶æ€ï¼Œè¿”å› `documentId` ç­‰å­—æ®µä¾›åç»­ä¸‹è½½æµç¨‹ä½¿ç”¨ã€‚ã€F:api/amazon/report-poll/index.jsâ€ L1-L84ã€‘

### Ozon
- `GET /api/ozon/stats`ï¼šæ”¯æŒ `date` æˆ– `start`/`end` èŒƒå›´ï¼Œè‡ªåŠ¨æ¢æµ‹å®é™…åˆ—åå¹¶èšåˆ SKU æŒ‡æ ‡ï¼ˆå±•ç¤ºã€è®¿å®¢ã€åŠ è´­ã€ä¸‹å•ç­‰ï¼‰ï¼›è‹¥æœªæŒ‡å®šæ—¥æœŸåˆ™è¿”å›æœ€æ–°æ—¥æœŸåˆ—è¡¨ä¾›é€‰æ‹©ã€‚ã€F:api/ozon/stats/index.jsâ€ L1-L120ã€‘
- `POST /api/ozon/import`ï¼šæ¥æ”¶ `file` å­—æ®µçš„æŠ¥è¡¨ï¼Œæ‰§è¡Œä¿„æ–‡è¡¨å¤´è½¬è›‡å½¢ã€åˆ—é‡æ˜ å°„ä¸å¿…å¡«æ ¡éªŒå upsert åˆ° `ozon_product_report_wide`ï¼Œå¹¶å¤„ç† Schema ç¼“å­˜åˆ·æ–°ã€‚ã€F:api/ozon/import/index.jsâ€ L1-L160ã€‘

### æŒ‡æ ‡å­—æ®µå…¼å®¹ç­–ç•¥
- **å¯é€‰å­—æ®µçº¦å®š**ï¼šç»Ÿä¸€è¿è¥æ¥å£çš„æ›å…‰ã€è®¿å®¢ã€åŠ è´­ã€è®¢å•ã€æ”¯ä»˜ã€GMV ç­‰å­—æ®µé»˜è®¤å¯ä¸ºç©ºï¼ˆ`null`ï¼‰ï¼Œè‹¥å¹³å°ç¼ºå¤±æŸå­—æ®µå¿…é¡»åœ¨å“åº”ä¸­æ˜¾å¼è¿”å› `null`ï¼Œå¹¶åœ¨ `meta.missingFields` ä¸­åˆ—å‡ºç¼ºå¤±é¡¹ï¼ŒåŒæ—¶åœ¨ README ä¸ `docs/platform-architecture.md` æ ‡æ³¨åŸå› ã€‚
- **æ›¿ä»£æŒ‡æ ‡è¯´æ˜**ï¼šå½“å¹³å°ä»…æä¾›ç›¸è¿‘æŒ‡æ ‡ï¼ˆå¦‚ TikTok ä»…æœ‰ `clicks`ï¼‰ï¼Œéœ€åœ¨å“åº”çš„ `meta.substitutions` å­—æ®µè®°å½•æ˜ å°„å…³ç³»ï¼ŒåŒæ—¶åœ¨ `specs/openapi.yaml` å’Œ `specs/metrics_dictionary.md` ä¸­ç™»è®°æ¢ç®—å£å¾„ã€‚
- **é”™è¯¯é˜²æŠ¤**ï¼šç¦æ­¢å› ä¸ºç¼ºå¤±å­—æ®µè¿”å› 500ï¼›è‹¥å…³é”®æŒ‡æ ‡ç¼ºå¤±å¯¼è‡´æ— æ³•è®¡ç®—æ¼æ–—ï¼Œåº”è¿”å› 422 å¹¶æä¾›å¯è¯»çš„ç¼ºå¤±å­—æ®µåˆ—è¡¨ã€‚

## é¡¹ç›®çŸ¥è¯†åº“ä¸çº¦æŸ
- `docs/platform-architecture.md`ï¼šå…¨ç«™æ¶æ„è“å›¾ï¼Œæè¿°ç«™ç‚¹çŸ©é˜µã€æ¨¡å—èŒè´£ã€æ•°æ®æµä¸æ‰§è¡Œå»ºè®®ã€‚ã€F:docs/platform-architecture.mdâ€ L1-L162ã€‘
- `rules.json`ï¼šçº¦æŸç«™ç‚¹å‘½åã€æ¨¡å—èŒƒå›´ã€API çº¦å®šã€æƒé™è§’è‰²åŠæ–‡æ¡£åŒæ­¥è¦æ±‚ï¼Œæ˜¯ä»£ç å®¡æŸ¥çš„ç¡¬æ€§è§„èŒƒã€‚ã€F:rules.jsonâ€ L1-L76ã€‘
- `roadmap.yaml`ï¼šè§„åˆ’ v1/v2/v3 çš„é‡ç‚¹äº¤ä»˜ã€æŒ‡æ ‡ã€é£é™©ä¸ç¼“è§£ç­–ç•¥ï¼ŒæŒ‡å¯¼å¤šæ¨¡å—å¹¶è¡Œå®æ–½ã€‚ã€F:roadmap.yamlâ€ L1-L63ã€‘
- `specs/`ï¼šåŒ…å« `openapi.yaml`ã€`data-model.sql`ã€`metrics_dictionary.md` ä¸‰å¤§è§„æ ¼æ–‡ä»¶ï¼Œç»Ÿä¸€æ¥å£ã€æ•°æ®ç»“æ„ä¸æŒ‡æ ‡å£å¾„ã€‚ã€F:specs/README.mdâ€ L1-L6ã€‘ã€F:specs/openapi.yamlâ€ L1-L612ã€‘ã€F:specs/data-model.sqlâ€ L1-L209ã€‘ã€F:specs/metrics_dictionary.mdâ€ L1-L20ã€‘

---

## Facebook Ads ä¼˜åŒ–è®°å½• (2025-01-07)

### ğŸ¯ ä¼˜åŒ–ç›®æ ‡
è§£å†³ Facebook Ads æ•°æ®æ˜¾ç¤ºé—®é¢˜ï¼Œå®ç°å•†å“IDå’Œå•†å“åçš„åˆ†ç¦»æ˜¾ç¤ºï¼ŒåŒæ—¶ç¡®ä¿ä¸å½±å“ç°æœ‰ `poolsvacuum` ç«™ç‚¹çš„åŠŸèƒ½ã€‚

### ğŸ”§ æ ¸å¿ƒä¼˜åŒ–å†…å®¹

#### 1. æ•°æ®åº“ç»“æ„ä¼˜åŒ–
- **æ–°å¢å­—æ®µ**ï¼šä¸º `independent_facebook_ads_daily` è¡¨æ·»åŠ  `product_name` å­—æ®µ
- **æ•°æ®æ ¼å¼ç»Ÿä¸€**ï¼šä¿®å¤ `independent_first_seen` è¡¨ä½¿ç”¨çº¯æ•°å­—å•†å“IDä½œä¸ºå”¯ä¸€æ ‡è¯†
- **å­—æ®µæ˜ å°„**ï¼š
  ```sql
  -- æ–°å¢å­—æ®µ
  ALTER TABLE public.independent_facebook_ads_daily 
  ADD COLUMN IF NOT EXISTS product_name TEXT;
  
  -- ä¿®å¤first_seenè¡¨æ•°æ®æ ¼å¼
  UPDATE independent_first_seen 
  SET product_identifier = TRIM(SPLIT_PART(product_identifier, ',', 1))
  WHERE product_identifier LIKE '%,%' 
    AND TRIM(SPLIT_PART(product_identifier, ',', 1)) ~ '^\d{10,}$';
  ```

#### 2. åç«¯APIä¼˜åŒ–
- **æ•°æ®ä¸Šä¼ é€»è¾‘**ï¼šè‡ªåŠ¨æ‹†åˆ† `product_identifier` ä¸º `product_id` å’Œ `product_name`
  ```javascript
  // æ‹†åˆ†é€»è¾‘ç¤ºä¾‹
  if (firstColumn.includes(',')) {
    const parts = firstColumn.split(',');
    productId = parts[0].trim();        // "50073860800824"
    productName = parts.slice(1).join(',').trim(); // "XREAL One AR Glasses..."
  }
  ```
- **å•†å“æ ‡è¯†æå–**ï¼šä¼˜åŒ– `extractProductId` å‡½æ•°ï¼Œä¼˜å…ˆä½¿ç”¨ `product_id` å­—æ®µ
- **äº§å“èšåˆé€»è¾‘**ï¼šæ”¯æŒå•†å“IDå’Œå•†å“ååˆ†ç¦»å­˜å‚¨å’ŒæŸ¥è¯¢
- **first_seenè¡¨æ›´æ–°**ï¼šç¡®ä¿ä½¿ç”¨çº¯æ•°å­—å•†å“IDä½œä¸ºå”¯ä¸€æ ‡è¯†

#### 3. å‰ç«¯æ˜¾ç¤ºä¼˜åŒ–
- **åˆ—å®šä¹‰æ›´æ–°**ï¼šFacebook Adsè¡¨æ ¼æ–°å¢å•†å“IDå’Œå•†å“ååˆ—
  ```javascript
  // æ–°å¢åˆ—å®šä¹‰
  { data: 'product_id', title: 'å•†å“ID', width: '120px' },
  { data: 'product_name', title: 'å•†å“åç§°', width: '200px' }
  ```
- **é”™è¯¯å¤„ç†å¢å¼º**ï¼šDataTablesåˆå§‹åŒ–å¤±è´¥æ—¶æ˜¾ç¤ºè¯¦ç»†é”™è¯¯ä¿¡æ¯
- **è°ƒè¯•ä¿¡æ¯ä¼˜åŒ–**ï¼šæ·»åŠ è¯¦ç»†çš„æ§åˆ¶å°è¾“å‡ºå¸®åŠ©å®šä½é—®é¢˜
- **è¡¨æ ¼æ¸²æŸ“ä¼˜åŒ–**ï¼šç¡®ä¿è¡¨æ ¼å…ƒç´ æ­£ç¡®åˆ›å»ºå’Œåˆå§‹åŒ–

#### 4. å…¼å®¹æ€§ä¿è¯
- **poolsvacuumç«™ç‚¹ä¿æŠ¤**ï¼šæ‰€æœ‰ä¼˜åŒ–éƒ½ç¡®ä¿ä¸å½±å“ç°æœ‰Google Adsæ•°æ®å±•ç¤º
- **å‘åå…¼å®¹**ï¼šä¿ç•™åŸæœ‰çš„ `product` å­—æ®µç”¨äºå…¼å®¹æ€§
- **æ¸ é“éš”ç¦»**ï¼šFacebook Adså’ŒGoogle Adsä½¿ç”¨ä¸åŒçš„æ•°æ®å¤„ç†é€»è¾‘

### ğŸ“ ç›¸å…³æ–‡ä»¶
- `api/independent/facebook-ingest/index.js` - Facebook Adsæ•°æ®ä¸Šä¼ é€»è¾‘
- `api/independent/stats/index.js` - æ•°æ®æŸ¥è¯¢å’Œèšåˆé€»è¾‘
- `public/independent-site.html` - å‰ç«¯è¡¨æ ¼æ˜¾ç¤ºé€»è¾‘
- `add_product_name_column.sql` - æ•°æ®åº“å­—æ®µæ·»åŠ è„šæœ¬
- `fix_independent_first_seen_table.sql` - first_seenè¡¨ä¿®å¤è„šæœ¬

### ğŸš€ éƒ¨ç½²è®°å½•
- **åˆ†æ”¯**ï¼š`feature/facebook-ads-complete-fields`
- **æäº¤è®°å½•**ï¼š
  - ä¿®å¤independent_first_seenè¡¨ç»“æ„ä¸ä¸€è‡´é—®é¢˜
  - ä¿®å¤Facebook Adså•†å“IDå’Œå•†å“åå¤„ç†é€»è¾‘
  - ç›´æ¥åº”ç”¨Facebook Adsæ˜¾ç¤ºä¼˜åŒ–
- **æµ‹è¯•çŠ¶æ€**ï¼šå·²éƒ¨ç½²åˆ°Vercelï¼Œç­‰å¾…åŠŸèƒ½éªŒè¯

### ğŸ” æ•…éšœæ’é™¤
å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. æµè§ˆå™¨æ§åˆ¶å°çš„è¯¦ç»†é”™è¯¯ä¿¡æ¯
2. ç½‘ç»œè¯·æ±‚æ˜¯å¦æˆåŠŸè¿”å›æ•°æ®
3. æ•°æ®åº“ä¸­çš„æ•°æ®æ ¼å¼æ˜¯å¦æ­£ç¡®
4. å‰ç«¯åˆ—å®šä¹‰ä¸åç«¯æ•°æ®å­—æ®µæ˜¯å¦åŒ¹é…

---

## TailAdmin UI ä¼˜åŒ–æ–½å·¥æŒ‡ä»¤

## ç›®æ ‡
- ä»¥ **TailAdmin React/Tailwind æ¨¡æ¿** ä¸ºè§†è§‰ä¸å¸ƒå±€è§„èŒƒï¼Œä¼˜åŒ–æœ¬ç«™æ¶æ„ä¸ UIï¼Œä½† **ä¸æ”¹å˜ç°æœ‰æ•°æ®ç»“æ„ä¸æ¥å£**ã€‚
- é‡‡ç”¨ **æ¸è¿›å¼é‡æ„**ï¼š
  - å…ˆåœ¨ç°æœ‰ HTML é¡µé‡Œæ›¿æ¢å¯¼èˆª / å¤´éƒ¨ / å¡ç‰‡æ ·å¼ä¸æ …æ ¼ï¼ˆå¤–è§‚å£³ï¼‰
  - ä¿æŒæ‰€æœ‰æ•°æ® DOM/ID ä¸ JS åˆå§‹åŒ–é€»è¾‘ä¸å˜
  - å¯é€‰å†æ–°å¢ä¸€ä¸ª `/admin` React ä»ªè¡¨ç›˜åŒº

---

## ç°çŠ¶ä¸çº¦æŸï¼ˆå¿…é¡»éµå®ˆï¼‰
1. **éƒ¨ç½²ç»“æ„**
   - å¹³å°ï¼šVercel é™æ€ + Serverless
   - é™æ€æ–‡ä»¶ï¼š`/public/**`
   - APIï¼š`/api/**` Node å‡½æ•°
   - è·¯ç”±è§„åˆ™è§ `vercel.json`

2. **éœ€è¦ä¼˜åŒ–çš„é¡µé¢**ï¼ˆåªæ¢ UI å£³ï¼Œä¸æ”¹æ•°æ® DOM/IDï¼‰
   - `/public/index.html`ï¼ˆå…¨æ‰˜ç®¡é¡µé¢ï¼‰
   - `/public/self-operated.html`ï¼ˆè‡ªè¿è¥é¡µé¢ï¼‰

3. **ç»Ÿä¸€ä¸»é¢˜**
   - ä½¿ç”¨ `assets/theme.css`ï¼ˆä»¥ `theme_unified_0811b.css` ä¸ºå‡†ï¼‰
   - æ·±è‰²ä¾§è¾¹æ  + æµ…è‰²å†…å®¹åŒº
   - é«˜å¯¹æ¯” DataTablesã€åˆ†æ®µ Tabs æ ·å¼
   - `.kpi` å•è¡Œå¡ç‰‡ï¼ˆè‡ªè¿è¥é¡µï¼‰å¸ƒå±€ä¿æŒä¸å˜

4. **æ¥å£åˆåŒä¸å¯æ›´æ”¹**
   - `/api/ae_upsert`ï¼ˆ`product_id, stat_date` å»é‡ï¼‰
   - `/api/stats`ã€`/api/ingest` ç­‰æŸ¥è¯¢/ä¸Šä¼  API ä¿æŒå‚æ•°ä¸è¿”å›ç»“æ„ä¸å˜

### é¡µé¢è·¯ç”±ç»“æ„
- è‡ªè¿è¥ï¼š`/self-operated.html#analysis`ã€`/self-operated.html#products`
- å…¨æ‰˜ç®¡ï¼š`/managed.html#analysis`ã€`/managed.html#products`
- ç‹¬ç«‹ç«™ï¼š`/independent-site.html?site=<name>#analysis`ã€`/independent-site.html?site=<name>#products`
  - æ—§çš„ `operation-analysis.html` ä¸ `product-analysis.html` é¡µé¢å·²åˆ é™¤
  - æ‰€æœ‰ç«™ç‚¹çš„è¿è¥åˆ†æä¸äº§å“åˆ†æé¡µåœ¨æ— ç”¨æˆ·é€‰æ‹©æ—¶é»˜è®¤å±•ç¤ºæœ€è¿‘ 7 å¤©çš„æ•°æ®èŒƒå›´
- è‡ªè¿è¥è¿è¥åˆ†æé¡µä»…å±•ç¤ºè®¿å®¢æ¯”ã€åŠ è´­æ¯”ã€æ”¯ä»˜æ¯”ï¼Œå¹¶é™„å¸¦ä¸Šä¸€å‘¨æœŸè¶‹åŠ¿å¯¹æ¯”
- è‡ªè¿è¥äº§å“åˆ†æé¡µçš„æ›å…‰ã€è®¿å®¢ã€åŠ è´­ä¸æ”¯ä»˜è¶‹åŠ¿ä»¥äº§å“é¦–æ¬¡ä¸Šæ¶æ—¥æœŸä¸ºèµ·ç‚¹æŒ‰å‘¨ç»˜åˆ¶ï¼Œå¹¶å¯¹ç¼ºå¤±å‘¨è‡ªåŠ¨è¡¥é›¶
- å…¨æ‰˜ç®¡äº§å“åˆ†æé¡µä»å•†å“ä¸Šæ¶å‘¨èµ·å±•ç¤ºæ›å…‰ã€è®¿å®¢ã€åŠ è´­ä¸æ”¯ä»˜çš„å‘¨è¶‹åŠ¿ï¼Œå¹¶æä¾›å¹³å‡è®¿å®¢æ¯”ã€å¹³å‡åŠ è´­æ¯”ã€å¹³å‡æ”¯ä»˜æ¯”åŠæ€»æ›å…‰/è®¿å®¢/åŠ è´­/æ”¯ä»˜ä¹°å®¶æ•°ç­‰ KPI å¡ç‰‡ï¼Œå«ä¸Šä¸€å‘¨æœŸå¯¹æ¯”ä¸ç«™ç‚¹å æ¯”
- å…¨æ‰˜ç®¡è¿è¥åˆ†æé¡µæä¾›è¿‡å»ä¸‰ä¸ªæœˆè®¿å®¢æ€»æ•°ã€åŠ è´­æ€»æ•°ã€æ”¯ä»˜æ€»æ•°ä¸‰æ¡ç‹¬ç«‹æ›²çº¿
- å…¨æ‰˜ç®¡äº§å“åˆ†æé¡µåœ¨å•†å“é€‰æ‹©è¡Œæä¾›ä¸æ•°æ®æ˜ç»†é¡µä¸€è‡´çš„å‘¨æœ«æ—¥æ—¶é—´æ§ä»¶ï¼Œå¹¶åœ¨è¯¥è§†å›¾ä¸‹éšè—é¡¶éƒ¨ä¸Šä¼ ä¸å‘¨æœŸæ 
- è‡ªè¿è¥ä¸å…¨æ‰˜ç®¡æ•°æ®æ˜ç»†é¡µæ–°å¢"æ›å…‰å•†å“æ•°"KPIï¼Œç»Ÿè®¡å½“å‰å‘¨æœŸå†…æ›å…‰é‡å¤§äº 0 çš„å•†å“æ•°é‡å¹¶ä¸ä¸Šå‘¨æœŸå¯¹æ¯”
- ç‹¬ç«‹ç«™è¿è¥åˆ†æé¡µå±•ç¤ºå¹³å‡ç‚¹å‡»ç‡ã€å¹³å‡è½¬åŒ–ç‡ã€æ›å…‰/ç‚¹å‡»/è½¬åŒ–å•†å“æ€»æ•°åŠæœ¬å‘¨æœŸæ–°å“æ•°ç­‰ KPI
  - ç‹¬ç«‹ç«™äº§å“åˆ†æä»¥ landing page ä½œä¸ºäº§å“ç»´åº¦ï¼Œé»˜è®¤å±•ç¤ºæœ¬å‘¨æœŸæ›å…‰é‡æœ€é«˜çš„äº§å“ï¼Œé€‰ä¸­åæ˜¾ç¤ºæ›å…‰ã€ç‚¹å‡»ã€è½¬åŒ–æ€»æ•°ä¸ CTR KPI ä»¥åŠå¯¹åº”é“¾æ¥å’Œé¦–æ¬¡ä¸Šæ¶æ—¥æœŸ
  - è¿è¥åˆ†æä¸äº§å“åˆ†ææ¨¡å—å„è‡ªæä¾›é¡¶éƒ¨æ—¶é—´æ§ä»¶ï¼ŒåŸå…ˆé¡µé¢é¡¶éƒ¨çš„æ—¥æœŸä¸ä¸Šä¼ æ å·²ç§»é™¤
  - æ•°æ®æ˜ç»†è¡¨ä¸­åŒå‡»äº§å“è¡Œå¯ç›´æ¥è·³è½¬åˆ°è¯¥äº§å“çš„åˆ†æé¡µ
  - äº§å“ä¸Šæ¶æ—¥æœŸä¸æ–°å“ç»Ÿè®¡æ¥æºäº `independent_first_seen` è¡¨ï¼Œå¹¶æ®æ­¤è®¡ç®—ç«™ç‚¹ç´¯è®¡äº§å“æ€»æ•°

---

## æ¨¡æ¿å‚è€ƒï¼ˆæ–°å¢è¯´æ˜ï¼‰
- **æ–‡ä»¶è·¯å¾„**ï¼š`/_design/tailadmin-react---tailwind-react-dashboard-template.zip`
- **ä½¿ç”¨èŒƒå›´**ï¼šå¯¼èˆªå¸ƒå±€ã€å¡ç‰‡æ ·å¼ã€é¢æ¿ã€è¡¨æ ¼å®¹å™¨ç­‰ UI ç»“æ„
- **å¥—ç”¨è¦æ±‚**ï¼š
  - ä»…æ›¿æ¢å¤–è§‚å£³ä¸æ ·å¼ç±»
  - ä¿ç•™ç°æœ‰æ•°æ® DOM ç»“æ„ã€ID å’Œå‰ç«¯ JS åˆå§‹åŒ–é€»è¾‘ï¼ˆDataTablesã€ECharts ç­‰ï¼‰
  - æ¨¡æ¿ä¸­çš„ç»„ä»¶å‘½åã€Tailwind ç±»åå¯æŒ‰éœ€è°ƒæ•´ï¼Œä½†ä¸å¾—å½±å“åŸåŠŸèƒ½

---

## ä»»åŠ¡æ¸…å•
### A. æ¥å…¥ TailAdmin å¤–è§‚å£³
1. ä»æ¨¡æ¿ä¸­æå–å¯¼èˆªã€å¤´éƒ¨ã€å¡ç‰‡ã€é¢æ¿ã€è¡¨æ ¼å®¹å™¨ç»“æ„ï¼Œåº”ç”¨åˆ° `index.html` ä¸ `self-operated.html`
2. ä¸æ”¹åŠ¨ä»¥ä¸‹ DOM/IDï¼š
   - DataTables å®¹å™¨ï¼š`#report`
   - ECharts å®¹å™¨ï¼š`#funnel`, `#sumCompareBar`, `#vrBar`, `#payBar` ç­‰
   - è‡ªè¿è¥ `.kpi .card` å¸ƒå±€ï¼ˆå•è¡Œæ¨ªå‘æ»šåŠ¨ï¼‰
3. `assets/theme.css` å¿…é¡»åœ¨æ‰€æœ‰ç¬¬ä¸‰æ–¹ CSS ä¹‹ååŠ è½½
4. ä¿ç•™ç°æœ‰ä¾§è¾¹æ å¯¼èˆªç»“æ„ä¸å±•å¼€/é«˜äº®é€»è¾‘

### B. å¯é€‰ï¼šæ–°å¢ React `/admin` ä»ªè¡¨ç›˜
1. åœ¨ä»“åº“æ ¹ç›®å½•æ–°å¢ `ui-dashboard/`ï¼Œç”¨ Vite/Next åˆå§‹åŒ– TailAdmin
2. æ„å»ºäº§ç‰©è¾“å‡ºåˆ° `/public/admin/**`ï¼ˆé™æ€æ‰˜ç®¡ï¼‰
3. `/admin` é¡µé¢è°ƒç”¨ç°æœ‰ `/api/**` æ¥å£ï¼Œä¸æ”¹å‚æ•°ä¸è¿”å›

---

## äº¤ä»˜è¦æ±‚
- ä»£ç æäº¤åˆ°åˆ†æ”¯ `feature/tailadmin-skin`
- `/public/index.html` ä¸ `/public/self-operated.html` æœ¬åœ°å¯ç›´æ¥æ‰“å¼€éªŒè¯
- ä¸»é¢˜ç»Ÿä¸€ï¼šæ·±è‰²ä¾§è¾¹æ  + ç™½è‰²å†…å®¹åŒº
- è‡ªè¿è¥ `.kpi` ä¿æŒå•è¡Œå¡ç‰‡å¸ƒå±€ï¼Œçª„å±æ¨ªå‘æ»‘åŠ¨
- æ‰€æœ‰ä¸Šä¼ ã€æŸ¥è¯¢ã€æ¸²æŸ“åŠŸèƒ½ä¸ä¸Šçº¿å‰ä¸€è‡´

- ## æŠ€æœ¯æ¶æ„

### ğŸ—ï¸ ç³»ç»Ÿæ¶æ„
- **å‰ç«¯**ï¼šHTML + JavaScript + DataTables + ECharts
- **åç«¯**ï¼šVercel Serverless Functions (Node.js)
- **æ•°æ®åº“**ï¼šSupabase (PostgreSQL)
- **éƒ¨ç½²**ï¼šVercel é™æ€æ‰˜ç®¡ + API è·¯ç”±

### ğŸ“ é¡¹ç›®ç»“æ„
```
â”œâ”€â”€ public/                 # é™æ€æ–‡ä»¶
â”‚   â”œâ”€â”€ index.html         # å…¨æ‰˜ç®¡é¡µé¢
â”‚   â”œâ”€â”€ self-operated.html # è‡ªè¿è¥é¡µé¢
â”‚   â”œâ”€â”€ independent-site.html # ç‹¬ç«‹ç«™é¡µé¢
â”‚   â””â”€â”€ assets/            # æ ·å¼å’Œè„šæœ¬
â”œâ”€â”€ api/                   # Serverless API
â”‚   â”œâ”€â”€ independent/       # ç‹¬ç«‹ç«™ç›¸å…³API
â”‚   â”‚   â”œâ”€â”€ facebook-ingest/ # Facebook Adsä¸Šä¼ 
â”‚   â”‚   â”œâ”€â”€ tiktok-ingest/   # TikTok Adsä¸Šä¼ 
â”‚   â”‚   â”œâ”€â”€ ingest/          # Google Adsä¸Šä¼ 
â”‚   â”‚   â””â”€â”€ stats/           # æ•°æ®æŸ¥è¯¢
â”‚   â””â”€â”€ ...
â””â”€â”€ vercel.json           # Vercelé…ç½®
```

### ğŸ—„ï¸ æ•°æ®åº“è®¾è®¡

#### ç»Ÿä¸€è¡¨æ¶æ„
- **`independent_facebook_ads_daily`**ï¼šFacebook Adsæ•°æ®
- **`independent_tiktok_ads_daily`**ï¼šTikTok Adsæ•°æ®
- **`independent_landing_metrics`**ï¼šGoogle Adsæ•°æ®
- **`site_channel_configs`**ï¼šç«™ç‚¹æ¸ é“é…ç½®

#### å…³é”®å­—æ®µ
```sql
-- ç»Ÿä¸€å­—æ®µ
site, day, campaign_name, impressions, clicks, spend_usd, conversions

-- Facebook Adsç‰¹æœ‰
adset_name, reach, frequency, cpm, cpc_all, all_ctr, product_id, product_name

-- TikTok Adsç‰¹æœ‰  
adgroup_name, ctr, cpc, conversion_value

-- Google Adsç‰¹æœ‰
network, device, landing_path, landing_url
```

### ğŸ”§ ç¯å¢ƒé…ç½®
```bash
# Supabaseé…ç½®
SUPABASE_URL=your_supabase_url
SUPABASE_ANON_KEY=your_anon_key
SUPABASE_SERVICE_ROLE_KEY=your_service_role_key

# å…¶ä»–é…ç½®
TEMP=/tmp  # ä¸´æ—¶æ–‡ä»¶ç›®å½•
```

## éƒ¨ç½²è¯´æ˜

### ğŸš€ Verceléƒ¨ç½²
1. è¿æ¥GitHubä»“åº“åˆ°Vercel
2. é…ç½®ç¯å¢ƒå˜é‡
3. è‡ªåŠ¨éƒ¨ç½²å®Œæˆ

### ğŸ“Š æ•°æ®åº“åˆå§‹åŒ–
```sql
-- åˆ›å»ºç«™ç‚¹æ¸ é“é…ç½®è¡¨
CREATE TABLE public.site_channel_configs (
  id SERIAL PRIMARY KEY,
  site_id TEXT NOT NULL,
  site_name TEXT NOT NULL,
  channel TEXT NOT NULL,
  table_name TEXT NOT NULL,
  is_enabled BOOLEAN DEFAULT true,
  created_at TIMESTAMP DEFAULT NOW(),
  UNIQUE(site_id, channel)
);

-- æ’å…¥é»˜è®¤é…ç½®
INSERT INTO public.site_channel_configs (site_id, site_name, channel, table_name, is_enabled) VALUES
('independent_poolsvacuum', 'poolsvacuum.com', 'google_ads', 'independent_landing_metrics', true),
('independent_icyberite', 'icyberite.com', 'facebook_ads', 'independent_facebook_ads_daily', true);
```

## ä½¿ç”¨æŒ‡å—

### ğŸ“¤ æ•°æ®ä¸Šä¼ 
1. é€‰æ‹©å¯¹åº”ç«™ç‚¹
2. æ ¹æ®æ¸ é“é€‰æ‹©ä¸Šä¼ APIï¼š
   - Google Ads â†’ `/api/independent/ingest`
   - Facebook Ads â†’ `/api/independent/facebook-ingest`
   - TikTok Ads â†’ `/api/independent/tiktok-ingest`
3. ä¸Šä¼ Excel/CSVæ–‡ä»¶

### ğŸ“ˆ æ•°æ®åˆ†æ
1. **æ•°æ®æ˜ç»†**ï¼šæŸ¥çœ‹åŸå§‹æ•°æ®ï¼Œæ”¯æŒå¤šç»´åº¦ç­›é€‰
2. **è¿è¥åˆ†æ**ï¼šKPIå¯¹æ¯”å’Œè¶‹åŠ¿åˆ†æ
3. **äº§å“åˆ†æ**ï¼šäº§å“è¡¨ç°å’Œè½¬åŒ–åˆ†æ

### ğŸ” æ¸ é“ç­›é€‰
- ä½¿ç”¨æ¸ é“é€‰æ‹©å™¨ç­›é€‰ç‰¹å®šå¹¿å‘Šå¹³å°æ•°æ®
- æ”¯æŒå¤šæ¸ é“æ•°æ®å¯¹æ¯”åˆ†æ
- è‡ªåŠ¨èšåˆä¸åŒæ¸ é“çš„KPIæŒ‡æ ‡

---

## è´¡çŒ® & åé¦ˆ

- ğŸ [æŠ¥å‘Š Bug](https://github.com/liuxuedata/aliexpress-analytics/issues/new?template=bug_report.md)
- âœ¨ [æå‡ºåŠŸèƒ½](https://github.com/liuxuedata/aliexpress-analytics/issues/new?template=feature_request.md)
- ğŸ›’ [ç”³è¯·æ¥å…¥ Amazon](https://github.com/liuxuedata/aliexpress-analytics/issues/new?template=amazon_onboarding.md)
- ğŸ”€ [å‘èµ· Pull Request](https://github.com/liuxuedata/aliexpress-analytics/compare)

> æäº¤ PR æ—¶è¯·éµå¾ª [.github/pull_request_template.md](.github/pull_request_template.md)

## æ›´æ–°æ—¥å¿—

### v2.1.0 (2025-01-07)
- âœ¨ Facebook Adså•†å“IDå’Œå•†å“ååˆ†ç¦»æ˜¾ç¤º
- ğŸ”§ ä¼˜åŒ–æ•°æ®ä¸Šä¼ é€»è¾‘ï¼Œè‡ªåŠ¨æ‹†åˆ†product_identifier
- ğŸ›¡ï¸ å¢å¼ºé”™è¯¯å¤„ç†å’Œè°ƒè¯•ä¿¡æ¯
- ğŸ”’ ç¡®ä¿poolsvacuumç«™ç‚¹åŠŸèƒ½ä¸å—å½±å“
- ğŸ“š å®Œå–„Facebook Adsä¼˜åŒ–æ–‡æ¡£

### v2.0.0 (2025-01-06)
- âœ¨ æ–°å¢å¤šæ¸ é“æ¶æ„æ”¯æŒ
- âœ¨ æ”¯æŒGoogle Adsã€Facebook Adsã€TikTok Ads
- âœ¨ ç»Ÿä¸€æ•°æ®è¡¨è®¾è®¡
- âœ¨ ç«™ç‚¹æ¸ é“é…ç½®ç®¡ç†
- ğŸ”§ ä¿æŒå‘åå…¼å®¹æ€§
- ğŸ“š å®Œå–„æŠ€æœ¯æ–‡æ¡£